<!DOCTYPE html>
<html>
<head>
    {% load staticfiles %}
    <script src={% static "/node_modules/chart.js/dist/Chart.js" %}></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    
    <style>
    .down{
        padding-left: 55px;
    }
    </style>
    
    <script>
        // Start of code to extract data from view 
            var question1_choice1_label = [];
            {% for item in question1_choice1_label %}
                question1_choice1_label.push({{ item|safe }});
            {% endfor %}

            var question1_choice2_label = [];
            {% for item in question1_choice2_label %}
                question1_choice2_label.push({{ item|safe }});
            {% endfor %}

            var question2_choice1_label = [];
            {% for item in question2_choice1_label %}
                question2_choice1_label.push({{ item|safe }});
            {% endfor %}

            var question2_choice2_label = [];
            {% for item in question2_choice2_label %}
                question2_choice2_label.push({{ item|safe }});
            {% endfor %}

            var question1_choice1 = [];
            {% for item in question1_choice1 %}
                question1_choice1.push({{ item|safe }})
            {% endfor %}

            var question1_choice2 = [];
            {% for item in question1_choice2 %}
                question1_choice2.push({{ item|safe }})
            {% endfor %}

            var question2_choice1 = [];
            {% for item in question2_choice1 %}
                question2_choice1.push({{ item|safe }})
            {% endfor %}

            var question2_choice2 = [];
            {% for item in question2_choice2 %}
                question2_choice2.push({{ item|safe }})
            {% endfor %}

            var questions = [];
            {% for item in questions %}
                questions.push({{ item|safe }});
            {% endfor %}

            var choices = [];
            {% for item in choices %}
                choices.push({{ item|safe }});
            {% endfor %}

            var votes = [];
            {% for item in votes %}
                votes.push({{ item|safe }});
            {% endfor %}

            var choices_chosen = [];
            {% for item in choices_chosen %}
                choices_chosen.push({{ item|safe }});
            {% endfor %}

        function getChart(){
            var ctx = document.getElementById('myChart').getContext('2d');
            var chart = new Chart(ctx, {
            // The type of chart we want to create
            type: 'horizontalBar',
            // The data for our dataset
            data: {
                labels: questions,
                datasets: [
                    //1st data set
                    {
                        label: question1_choice1_label,
                        data: question1_choice1,
                        backgroundColor: [
                            'rgb(200, 97, 59)',
                            
                            ],
                        borderColor: [
                            'rgba(200, 97, 59)'
                            ],
                    },
                    
                    //2nd data set
                    {
                        label: question1_choice2_label,
                        data: question1_choice2,
                        backgroundColor: [
                            'rgb(245, 222, 47)',
                            'rgb(245, 222, 47)',
                        ],
                        borderColor: [
                            'rgba(245, 222, 47)',
                        ],                                  
                    },
                    //3rd data set
                    {
                        label: question2_choice1_label,
                        data: question2_choice1,
                        backgroundColor: [
                            'rgb(245, 100, 47)',
                            'rgb(245, 100, 47)',
                        ],
                        borderColor: [
                            'rgba(245, 100, 47)',
                        ],                                  
                    },

                    {
                        label: question2_choice2_label,
                        data: question2_choice2,
                        backgroundColor: [
                            'rgb(105, 100, 255)',
                            'rgb(105, 100, 255)',
                        ],
                        borderColor: [
                            'rgba(105, 100, 255)',
                        ],                                  
                    },
                ]
            },
        
            // Configuration options go here
            options: {
                responsive:true,
                fullWidth: true,
                title: {
                    display:true,
                    text: 'Questions Voted',
                    position:'top'
                },
                scales: {
                    xAxes: [{
                        stacked: true,
                            gridLines: {
                                display:false
                            },
                            ticks:{
                                    beginAtZero: true
                                }
                    }],
                    yAxes: [{
                        stacked: true,
                        barThickness : 10,
                        maxBarThickness: 10,    
                            gridLines: {
                                display:false
                            }
                    }]
                },
                legend:{
                    position: 'top',
                        labels:{
                            boxWidth: 12
                        }
                }
            }
        });
        }
        function getChart2(){
            var ctx = document.getElementById('myChart2').getContext('2d');
            var chart = new Chart(ctx, {
            // The type of chart we want to create
            type: 'doughnut',
        
            // The data for our dataset
            data: {
                labels: questions,
                datasets: [{
                    label: "My First dataset",
                    backgroundColor: [
                        'rgb(145, 227, 96)',
                        'rgb(34, 180, 247)'
                        ],
                    borderColor: [
                        'rgb(145, 227, 96)',
                        'rgb(34, 180, 247)'
                        ],
                    data: choices_chosen,
                }]
            },
        
            // Configuration options go here
            options: {
                responsive:true,
                cutoutPercentage: 90,
                fullWidth: true,
                title: {
                    display:true,
                    text: 'Questions Voted For',
                    position:'top'
                },
                    legend: {
                        display: true,
                        position: 'right',
                            labels: {
                                usePointStyle: true
                            }
                    }
            }
        });
        }
        function getChart3(){
            var ctx = document.getElementById('myChart3').getContext('2d');
            var chart = new Chart(ctx, {
            // The type of chart we want to create
            type: 'doughnut',
        
            // The data for our dataset
            data: {
                labels: choices,
                datasets: [{
                    label: "Chosen Answers",
                    backgroundColor: [
                        'rgb(72, 116, 246)',
                        'rgb(84, 31, 181)',
                        'rgb(191, 240, 42)',
                        'rgb(254, 156, 62)',
                        'rgb(238, 74, 85)'
                        ],
                    borderColor: [
                        'rgb(72, 116, 246)',
                        'rgb(84, 31, 181)',
                        'rgb(191, 240, 42)',
                        'rgb(254, 156, 62)',
                        'rgb(238, 74, 85)'
                        ],
                    data: votes,
                }]
            },
        
            // Configuration options go here
            options: {
                responsive:true,
                cutoutPercentage: 60,
                title: {
                    display:true,
                    text: 'Chosen Answers',
                    position:'top'
                },
                    legend:{
                        position:'right',
                        align: 'center',
                        labels: {
                                usePointStyle: true,
                                fontSize: 11
                        }
                    }
                }
            });
        }
        </script>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-lg-4 col-sm-12">
            <canvas id="myChart"></canvas>
            <p class="down"></p>
            </div>
            <div class="col-lg-4 col-sm-12">
            <canvas id="myChart2"  style="height: 30px; width: 60px;"></canvas>
            <p class="down"></p>
            </div>
            <div class="col-lg-4 col-sm-12">
            <canvas id="myChart3" style="height: 30px; width: 60px;"></canvas>
            <p class="down"></p>
            </div>
        </div>
    </div>

    <script>   
        getChart();
        getChart2();
        getChart3();
    </script>

    <div class="container" style="position: absolute; left: 450px;">
        <form action="{% url 'polls:charts' %}" method="post">
            {% csrf_token %}
            {% for choice in choice %}
                <input type="radio" name="choice" id="choice{{ forloop.counter }}" value=
                "{{ choice.id }}" />
                <label for="choice{{ forloop.counter }}">{{ choice.choice_text }}</label><br />
            {% endfor %}
            <input type="submit" value="Vote" class="btn btn-primary"/>
        </form>
    </div>

    <div class="d-none d-xl-block" style="z-index: 2; position: absolute; top: 5.75em; left: 43.75%;">
            xl halo
        </div>
        <div class="d-none d-lg-block d-xl-none" style="font-size: 12px; z-index: 2; position: absolute; top: 6.5em; left: 43%;">
            lg halo
        </div>
        <div class="d-none d-md-block d-lg-none" style="z-index: 2; position: absolute; top: 33.75em; left: 39.5%;">
            md halo
        </div>
        <div class="d-none d-sm-block d-md-none" style="font-size: 13px; z-index: 2; position: absolute; top: 31.5em; left: 36%;">
            small halo
        </div>
        <div class="d-block d-sm-none" style="font-size: 12px; position: absolute; top: 21.75em; left: 8em;">
            xs halo
        </div>
</body>
</html>